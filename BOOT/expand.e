(DEFINE EXPAND-ONCE (LAMBDA (EXP) (IF (NOT (PAIR? EXP)) EXP ((LAMBDA (EXP-BIND) ((LAMBDA (EXPANDER) (BEGIN (IF (NULL? EXPANDER) (MAP1 EXPAND-ONCE EXP) (EXPANDER EXP)))) (AND (NOT (NULL? EXP-BIND)) (CDR EXP-BIND)))) (ASSOC (CAR EXP) *EXPANSION-TABLE*)))))
(DEFINE EXPAND (LAMBDA (EXP) (IF (NOT (PAIR? EXP)) EXP ((LAMBDA (EXP-BIND) (IF (NULL? EXP-BIND) (MAP1 EXPAND EXP) (EXPAND ((CDR EXP-BIND) EXP)))) (ASSOC (CAR EXP) *EXPANSION-TABLE*)))))
