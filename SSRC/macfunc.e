(DEFINE EXPAND-COND (LAMBDA (E) (IF (NULL? (CDR E)) #F (IF (NOT (PAIR? (CADR E))) (ERROR "illegal cond syntax") (IF (EQ? (QUOTE ELSE) (CAADR E)) (APPEND (QUOTE (BEGIN)) (CDADR E)) (IF (NULL? (CDADR E)) (LIST (QUOTE OR) (CAADR E) (APPEND (QUOTE #F) (CDDR E))) (LIST (QUOTE IF) (CAADR E) (APPEND (QUOTE (BEGIN)) (CDADR E)) (APPEND (QUOTE #F) (CDDR E)))))))))